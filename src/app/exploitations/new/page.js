import nextDynamic from 'next/dynamic'

import {getPointsPrelevement, getPreleveurs} from '@/app/api/points-prelevement.js'
import ExploitationCreationForm from '@/components/form/exploitation-creation-form.js'
import {StartDsfrOnHydration} from '@/dsfr-bootstrap/index.js'

const DynamicBreadcrumb = nextDynamic(
  () => import('@codegouvfr/react-dsfr/Breadcrumb')
)
export const dynamic = 'force-dynamic'

const Page = async ({searchParams}) => {
  const points = await getPointsPrelevement()
  const preleveurs = await getPreleveurs()
  const {idPoint} = await searchParams

  return (
    <div>
      <StartDsfrOnHydration />
      <div className='p-5'>
        <DynamicBreadcrumb
          currentPageLabel='CrÃ©ation'
          homeLinkProps={{
            href: '/'
          }}
          segments={[]}
        />
      </div>
      <ExploitationCreationForm
        idPoint={idPoint}
        points={points}
        preleveurs={preleveurs}
      />
    </div>
  )
}

export default Page
