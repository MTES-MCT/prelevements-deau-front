/* eslint-disable camelcase */
import test from 'ava'

import {sortByEndDate, sortByRecurrence, sortByStatus} from './exploitation.js'

test('sortByStatus puts "En activité" before any other status', t => {
  const arr = [
    {statut: 'Abandonné'},
    {statut: 'En activité'},
    {statut: 'Suspendu'},
    {statut: 'En activité'}
  ]

  const sorted = arr.sort(sortByStatus)
  t.deepEqual(sorted.map(e => e.statut), [
    'En activité',
    'En activité',
    'Abandonné',
    'Suspendu'
  ])
})

test('sortByEndDate sorts by date_fin (desc)', t => {
  const arr = [
    {date_fin: '2020-01-01'},
    {date_fin: '2022-05-10'},
    {date_fin: '2021-12-31'}
  ]
  const sorted = arr.sort(sortByEndDate)
  t.deepEqual(sorted.map(e => e.date_fin), [
    '2022-05-10',
    '2021-12-31',
    '2020-01-01'
  ])
})

test('sortByEndDate puts objects without a date_fin at the end', t => {
  const arr = [
    {date_fin: '2021-01-01'},
    {date_fin: null},
    {},
    {date_fin: '2022-01-01'}
  ]
  const sorted = arr.sort(sortByEndDate)
  t.deepEqual(sorted.map(e => e.date_fin), [
    '2022-01-01',
    '2021-01-01',
    null,
    undefined
  ])
})

test('sortByRecurrence puts the year 0001 at the end', t => {
  const arr = [
    {date_debut: '0001-01-01'},
    {date_debut: '2020-05-01'},
    {date_debut: '2019-12-31'},
    {date_debut: '0001-06-01'}
  ]
  const sorted = arr.sort(sortByRecurrence)
  t.deepEqual(sorted.map(e => e.date_debut), [
    '2020-05-01',
    '2019-12-31',
    '0001-06-01',
    '0001-01-01'
  ])
})

